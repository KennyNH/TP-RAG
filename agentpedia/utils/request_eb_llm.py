import requests
import json

api_url = {
    "eb_speed_pro": "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/jiuv36gb_agent_pedia?access_token=",
    "eb_lite": "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/q7a7m94s_agent_pedia?access_token=",
    "eb_lite_0912": "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/iny19xy0_agent_pedia?access_token="
}


def get_access_token():
    """
    使用 API Key，Secret Key 获取access_token，替换下列示例中的应用API Key、应用Secret Key
    """

    url = "https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&client_id=PwRI1n2yn1tEVt9AAKz9mpg6&client_secret=Jgx2XEqu0YlN1nsnxXebDyvESk8ZE8r6"

    payload = json.dumps("")
    headers = {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
    }

    response = requests.request("POST", url, headers=headers, data=payload)
    return response.json().get("access_token")


def request_eb(content, model_name):
    """
    请求EB

    Args:
        content (str): prompt
        model_name (str): 模型名称

    Returns:
        str: 返回EB API的响应结果，包括回复内容和其他信息。如果请求失败或模型名称错误，则返回空字符串。
    """
    if model_name not in api_url:
        return ""
    url = api_url[model_name] + get_access_token()

    payload = json.dumps({
        "messages": [
            {
                "role": "user",
                "content": content,
            }
        ],
        "temperature":0.00001,
        "system":"你是一名搜索seo工程师",
        "max_output_tokens":2048
        
    })
    headers = {
        'Content-Type': 'application/json'
    }

    response = requests.request("POST", url, headers=headers, data=payload)
    json_response = json.loads(response.text)
    return json_response.get("result", "")


def request_eb_stream(content, model_name):
    """
    请求EB，流式返回
    Args:
        content (str): prompt
        model_name (str): 模型名称

    Returns:
        str:
    """
    if model_name not in api_url:
        return ""
    url = api_url['model_name'] + get_access_token()

    payload = json.dumps({
        "messages": [
            {
                "role": "user",
                "content": content,
            }
        ],
        "stream": True,
        "temperature":0.00001,
        "system":"你是一名搜索seo工程师",
        "max_output_tokens":2048
    })
    headers = {
        'Content-Type': 'application/json'
    }

    response = requests.request("POST", url, headers=headers, data=payload, stream=True)

    print(response.headers)
    for line in response.iter_lines():
        print(line.decode("UTF-8"))


if __name__ == '__main__':
    content = '#指令描述\n\n你的任务是根据文章内容，对文章进行压缩、去重、合并和提炼总结。\n\n#任务要求\n\n1.请删除文章中前后重复的内容，删除其他方法、其他推荐、其他方案等内容；确保每个观点或信息只出现一次；一定要保留用户经验分享、个人经历等内容；一定要保留文章引用序号，比如^[1]^、^[4, 66]^等。\n2.将意思相同或相近的内容合并在一起，生成新的目录内容，不要删除一级标题（#），确保信息完整且表达清晰。\n3.请删除来源、参考来源目录下的内容，请删除文章中的结论、总结性内容。\n4.内容上使用markdown格式，所有内容优先用表格来组织具体细节。\n5.尽量用换行、列表等丰富的格式来组织答案，重点内容加粗、高亮等。\n\n#输入\n\n文章内容：# 祛痘印最有效的药物和护肤品\n\n## 药物\n\n### Ellia凝胶\nEllia凝胶是治疗痘痘和痘印的明星产品，成分温和不含素，乳液凝胶质地，涂在脸上冰凉舒适，吸收速度快，对痘印有很好的舒缓消退效果。用户坚持使用半个月后，浅红色痘印淡化到接近正常肤色，黑色痘印也有明显改善^[1, 30]^。\n\n### 积雪苷霜软膏\n积雪苷霜软膏主要用于修复疤痕，但对痘印也有一定程度的淡化效果。成分温和，适合大多数肤质。用户使用两个月后，浅红色痘印基本看不见，但黑色痘印变化不明显。质地厚重，使用时需薄涂，避免闷痘^[1, 77]^。\n\n### 阿达帕林凝胶\n阿达帕林凝胶是第三代维A酸，具有光敏性，通常在晚上使用。用户反馈其对粉刺和闭口的效果更好，但刺激性较强，使用时需建立耐受。一个月后，粉刺和闭口改善明显^[1, 105]^。\n\n### 水杨酸苯甲酸松油搽剂\n此药物具有抗菌和角质层剥离作用，能帮助清除毛孔内的污垢和死皮细胞，减少痤疮的发生，并具有轻微的消炎效果^[4]^。\n\n### 维A酸乳膏\n维A酸乳膏是维生素A的衍生物，能促进细胞更新和角质层脱落，减少毛孔堵塞和痤疮的形成，同时改善肌肤质地，减淡痘痕^[4]^。\n\n### 氢醌乳膏\n氢醌乳膏能抑制黑色素的合成，减轻色素沉着，改善痤疮引起的不适症状，有利于去除痘痕^[4]^。\n\n### 夫西地酸乳膏\n夫西地酸乳膏是一种外用抗感染药，具有抗菌作用，主要用于治疗敏感菌引起的皮肤感染，可用于治疗痤疮和痘痕^[4]^。\n\n## 护肤品\n\n### 理肤泉B5修护霜\n理肤泉B5修护霜主要成分是维生素B5和雪亚脂，能有效修复表皮，舒缓皮肤不适，防止皮肤上的痕迹。使用时需局部点涂，避免闷痘^[3, 65]^。\n\n### Lay淡斑精华\nLay淡斑精华含有烟酰胺，能美白祛痘、控油收缩毛孔，使用后皮肤不黏腻，吸收快。用户使用两瓶后痘印淡化^[3, 91]^。\n\n### 伊索滋润舒缓修护面霜\n伊索滋润舒缓修护面霜提供深层保湿功能，出色的吸收能力能改善肌肤缺乏营养的状况，让肌肤变得柔软有光泽^[8]^。\n\n### 植物图书馆祛痘膏\n植物图书馆祛痘膏含有十几种纯天然植物配方，对痘痘、闭口白头、红肿瘙痒、痤疮脓包效果显著。用户反馈使用后皮肤变得光滑细腻^[8]^。\n\n### 肌克祛痘水\n肌克祛痘水由皮肤科医生推荐，权威医学期刊表明祛痘率高达98%，能有效消炎祛痘印。用户反馈使用后痘痘逐渐消失^[8]^。\n\n### 杜克加强版色素修复凝胶\n杜克加强版色素修复凝胶能改善肤色不均，成分温和适合敏感肌使用，能阻止皮肤新的黑色素形成，缓解肌肤发炎和泛红^[8]^。\n# 快速见效的祛痘印方法\n\n## 🍋 酸奶去痘印\n使用喝剩的酸奶，将其涂在有痘印的地方，第二天再洗掉。酸奶中的营养物质可以有效去除痘印，坚持两周会有明显效果^[13]^。\n\n## 🌸 珍珠粉去痘印\n将生鸡蛋的蛋清和一小勺药用珍珠粉混合，涂在脸上，避开眼部和唇部，涂厚一点，15到20分钟后洗掉。珍珠粉具有美白和修复作用^[13]^。\n\n## 🍎 苹果去痘印\n将苹果切成薄片，敷在有痘印的地方，保持20分钟后取下，用清水洗净。苹果中的果酸有助于淡化痘印^[13]^。\n\n## 🍋 白芷粉+绿豆粉消痘印\n将白芷粉和绿豆粉按1:1的比例混合调匀，敷在脸上，15到20分钟后洗净。白芷粉和绿豆粉具有消炎和美白作用^[13]^。\n\n## 🥔 土豆片去痘印\n将土豆片切成薄片，敷在有痘印的地方，能够有效去除痘印^[13]^。\n\n## 🌿 芦荟去痘印\n芦荟含有天然的消炎和抗氧化成分，将芦荟叶片中的果冻状物质取出来，涂抹在痘印处，让其干燥后用水冲洗即可^[14]^。\n\n## 🍋 维生素C去痘印\n将维生素C粉末混合在适量的普通面霜或乳液中，涂抹在脸上，特别是痘印处。维生素C可以促进皮肤细胞再生，减轻痘印^[14]^。\n\n## 🌿 茶树油去痘印\n茶树油具有天然的抗菌和抗炎作用，将一滴茶树油涂抹在痘印处，最好在晚上使用^[14]^。\n\n## 🍋 白醋去痘印\n洗脸时在温水中倒入少量白醋，将脸浸入水中让皮肤吸收3-5分钟后，用清水洗脸即可。白醋有软化角质层、淡化色素和美白杀菌的功效^[20]^。\n\n## 🍋 淘米水去痘印\n淘米水中含有丰富的营养物质，可以起到祛除痘印的作用与效果^[20]^。\n\n## 🍋 蜂蜜柠檬面膜\n将蜂蜜和柠檬混合成面膜，敷在脸上可以起到祛除痘印的效果^[20]^。\n\n## 🍋 生姜片去痘印\n每天擦涂三次生姜片，可以起到祛除痘印的效果^[20]^。\n\n## 🍋 白糖去痘印\n将白糖涂洒在痘印上，可以起到祛除痘印的效果^[20]^。\n# 激光和其他医美手段祛痘印\n\n## 激光治疗\n\n激光治疗是祛除痘印的常用方法之一。激光治疗可以通过光热效应快速分解皮肤中的色素，促进胶原蛋白的再生，从而达到淡化痘印的效果^[21][22][23][24][25][27][28]^。激光治疗的效果显著且快速，每次治疗后都能看到明显的效果^[21]^。激光治疗的安全性较高，能量的发射由激光严格控制，因此安全性相对较大^[21]^。\n\n### 不同类型激光\n\n- **点阵激光**：通过激光在皮肤上均匀打上微细的小孔，穿透至真皮层，刺激胶原再生，适用于较深的痘坑和痘印^[22][25][27]^。剥脱性点阵激光效果更好，但恢复期长且有一定痛感^[25]^。\n- **皮秒激光**：纳秒级的激光，在短时间内对色素部分产生爆破作用，直接粉碎黑色素颗粒，通过巨噬细胞吞噬循环代谢出去，适用于黑色痘印^[22]^。\n- **光子嫩肤**：利用强脉冲能量刺激胶原蛋白增生，分解黑色素颗粒，适用于肤色暗沉和暗黄的痘印^[22]^。\n\n## 光子嫩肤\n\n光子嫩肤通过宽光谱彩光作用于皮肤，加速皮肤的新陈代谢，刺激皮肤中的弹性细胞再生，从而达到祛除痘印的目的^[23][24]^。光子嫩肤对痘印的治疗没有限制，通常四到六次治疗可以明显改善色素问题^[22]^。\n\n## 果酸焕肤\n\n果酸焕肤通过涂抹高浓度的果酸到皮肤上，加速皮肤的代谢和更新，减轻色素沉着，改善痘印^[23][29]^。果酸焕肤适用于非过敏性、耐受性皮肤^[28]^。\n\n## 微针治疗\n\n微针治疗通过微针注射的方式，刺激皮肤深层的胶原蛋白再生，淡化痘印和疤痕^[30]^。微针可以修复痘坑，促进皮肤细胞再生和血液循环^[23][29]^。\n\n## 水光针治疗\n\n水光针的主要成分是玻尿酸和透明质酸，注射到皮肤部位后能补水和锁水，促使皮肤的新陈代谢，从而祛除痘印^[24]^。水光针的效果显著且安全^[21]^。\n\n## 其他方法\n\n- **代谢色素沉着的药品**：通过使用代谢色素沉着的药品来达到祛除痘印的效果^[21]^。\n- **局部药物治疗**：使用含有祛痘成分的药膏或液体直接作用于皮肤，淡化痘印和疤痕^[30]^。\n- **饮食调理**：多吃富含维生素C、E、锌等成分的食物，如柑橘类水果、绿叶蔬菜、坚果等，有助于改善皮肤状况^[30]^。\n- **注意防晒**：涂抹防晒霜避免阳光直接照射皮肤，防止痘印加深^[30]^。\n- **坚持运动锻炼**：适当的运动可以促进血液循环和新陈代谢，改善皮肤状况^[30]^。\n- **心情愉快**：保持心情愉快，减少压力和焦虑，有助于减少痘印的发生^[30]^。'
    print(request_eb(content, "eb_lite"))
